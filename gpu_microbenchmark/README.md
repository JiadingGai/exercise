#
nvcc -O3 -o cpi_overhead cpi_overhead.cu --keep --arch=sm_86

root@ceb39cf1eb54:~# ./cpi_overhead --sweep
Device: NVIDIA RTX A5000 sm_86 | SMs=64
Args: sweep=on iters=90000 smem_f=4096 wss_kb=256
op   c  unroll     iters         cycles          insts    CPI(thread)   CPIx32(warp)    CPI_pure(t)    CPI_purex32
---- -- ------ --------- -------------- -------------- -------------- -------------- -------------- --------------
lds  --      1     90000        4950084        2880000     1.71877917    55.00093333     0.87501667    28.00053333
lds  --      2     90000        5490082        5760000     0.95313924    30.50045556     0.53125833    17.00026667
lds  --      4     90000        7470084       11520000     0.64844479    20.75023333     0.40625391    13.00012500
lds  --      8     90000       12150043       23040000     0.52734562    16.87505972     0.32421836    10.37498750
lds  --     16     90000       21330109       46080000     0.46289299    14.81257569     0.27734377     8.87500069
lds  --     32     90000       39330237       92160000     0.42676038    13.65633229     0.25097688     8.03126007
lds  --     64     90000       75420491      184320000     0.40918235    13.09383524     0.23730507     7.59376215
ldg  ca      1     90000       16830778        2880000     5.84402014   187.00864444             --             --
ldg  ca      2     90000       27123744        5760000     4.70898333   150.68746667             --             --
ldg  ca      4     90000       31302941       11520000     2.71726918    86.95261389             --             --
ldg  ca      8     90000       61729604       23040000     2.67923628    85.73556111             --             --
ldg  ca     16     90000      111551868       46080000     2.42083047    77.46657500             --             --
ldg  ca     32     90000      213850321       92160000     2.32042449    74.25358368             --             --
ldg  ca     64     90000      417885561      184320000     2.26717427    72.54957656             --             --
ldg  cg      1     90000       26893387        2880000     9.33798160   298.81541111             --             --
ldg  cg      2     90000       28123003        5760000     4.88246580   156.23890556             --             --
ldg  cg      4     90000       31526773       11520000     2.73669905    87.57436944             --             --
ldg  cg      8     90000       80933184       23040000     3.51272500   112.40720000             --             --
ldg  cg     16     90000      116090514       46080000     2.51932539    80.61841250             --             --
ldg  cg     32     90000      225095601       92160000     2.44244359    78.15819479             --             --
ldg  cg     64     90000      442328081      184320000     2.39978343    76.79306962             --             --

# 

nvdisasm -g -c ./cpi_2.sm_86.cubin | grep -n 'Function : micro_lds_kernel_spec'
nvdisasm -g -c ./cpi_2.sm_86.cubin | grep -n 'LDS\.128' -n
